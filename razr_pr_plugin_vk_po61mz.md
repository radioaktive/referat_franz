
РЕФЕРАТ
---

по дисциплине «Разработка и реализация сетевых протоколов »

на тему «Плагин сообщений vk.com для мессенджера Franz»




Содержание
---
Введение
Текст программы
Описание программы
Список использованных источников
Приложение А
Приложение Б
Приложение В
Приложение Г




Введение
---
Логический интерфейс (называемый также протоколом) — это набор информационных сообщений определенного формата, которыми обмениваются два устройства или две программы, а также набор правил, определяющих логику обмена этими сообщениями [Олифер, с.41].

Приложения А и В  управляют процессом передачи данных путем обмена сообщениями. Чтобы приложения могли «понимать» получаемую друг от друга информацию, программисты, разрабатывавшие эти приложения, должны строго оговорить форматы и последовательность сообщений, которыми приложения будут обмениваться во время выполнения этой операции. Например, они могут договориться о том, что любая операция
обмена данными начинается с передачи сообщения, запрашивающего информацию о готовности приложения В; что в следующем сообщении идут идентификаторы компьютера и пользователя, сделавшего запрос; что признаком срочного завершения операции обмена данными является определенная кодовая комбинация и т. п. Тем самым определяется протокол взаимодействия приложений для выполнения операции данного типа [Олифер, с.43].

В настоящем существует эволюционная проблема, связанная с тем, что Интернет создавался как среда отображения страниц с гипертекстовой разметкой, а в данный момент в связи с развитем сайтов-приложений,  мессенджеров, сетевых игр и др. существует запрос на Интернет как среду исполнения приложений.
Вот как об этом пишет Тимур Шемсединов:
" У HTTP очень много проблем, их пробовали решать при помощи Websocket, SSE, SPDY, HTTP/2, QUIC но все они зависят от бесчисленного множества вещей, которые достались в наследство от ветхого веба и ни одна из этих технологий не достигла ни приемлемых характеристик, ни широкой поддержки. Уплотнить уже имеющийся трафик, сделать мультиплексацию внутри другого транспорта можно, но структура трафика не изменится, это будут все те же HTML, AJAX, JSON, ведь задача стояла, починить транспорт так, чтобы ничего не сломалось и чрез него продолжали ходить все те же приложения...
Для игр, мессенджеров и других интерактивных приложений сейчас есть только один живой вариант — это Websocket, но этот слоеный пирог из протоколов достиг предела. IP пакетный, на его основе TCP потоковый с установлением долгих соединений, сверху HTTP — он опять пакетный с постоянным отключением и поверху Websocket — и он потоковый, с долгими соединениями. А еще все это через SSL может идти. И каждый слой добавляет свои заголовки и преобразовывает данные, особенно при переходе от пакетного к потоковому и от потокового к пакетному. Это похоже на издевательство, честное слово.
Поэтому игры и мессенджеры часто не имеют достаточной интерактивности, оно подглючивают, нет нужной отзывчивости в доставке, много накладных расходов и задержек, да и пропускной способности нужной добиться не так просто. Вот интерактивные приложения и завязли в развитии, особенно благодаря тому, что нет в широком доступе хороших средств прозрачного масштабирования вебсокетов на десятки миллионов одновременных соединений. Каждый, кому нужно выйти за пределы десятков тысяч соединений, уже делает это для себя сам, хорошего рецепта нет [Шемсединов]."

В практической части данной работы мы напишем плагин (recipe) для получения и отправки сообщений социальной сети vk.com для месенджера Franz.
Мессенджер Franz это open source мессенджер, объединяющий в одном приложении такие мессенджеры и чат-сервисы как WhatsApp, Telegram, Slack, Facebook Messenger, Skype, Discord, WeChat и многие другие. В настоящий момент доступна только десктоп-версия приложения.

Текст программы
---
Согласно  ГОСТ 19.401-78 «Единая система программной документации (ЕСПД). Текст программы. Требования к содержанию и оформлению» текст программы оформляют следующим образом. п.2 Структуру и оформление документа устанавливают в соответствии с ГОСТ 19.105-78. Составление информационной части (аннотации и содержания) является необязательным. Для текста программы на исходном языке при наличии аннотации в нее включают краткое описание функций программы. п.3. Основная часть документа должна состоять из текстов одного или нескольких разделов, которым даны наименования. Допускается вводить наименование также и для совокупности разделов. п.4. … В символическую запись разделов рекомендуется включать комментарии,
которые могут отражать, например, функциональное назначение, структуру [ГОСТ 19.401].

Текст программы главного файла плагина index.js на языке JavaScript представлен в  приложении A (Приложение A).
Текст программы файла webview.js  на языке JavaScript представлен в приложении Б (Приложение Б).
Текст программы файла package.json в формате json представлен в приложении Б (Приложение В).
Текст программы файла service.css  на языке CSS представлен в приложении Г (Приложение Г).



Описание программы
---

- Общие сведения.
- Обозначение и наименование программы:
"Плагин сообщений vk.com для мессенджера Franz."
- Программное обеспечение, необходимое для функционирования программы:
1. Операционная система:
MS Windows 7 и новее;
macOS 10.9 и новее;
Ubuntu Linux.
2. Мессенджер Franz  5.0.0-beta (beta).
Мессенджер Franz доступен для скачивания бесплатно с оф. сайта https://meetfranz.com .
3. Аккаунт на vk.com .

- Языки программирования, на которых написана программа.
Основной функционал плагина написан на языке JavaScript,  
файлы index.js см. приложение A (Приложение A),
webview.js см. приложение Б (Приложение Б),
package.json см. приложение В (Приложение В).
Файл service.css  см. приложение Г (Приложение Г) написан на языке css.

- Функциональное назначение.
Плагин сообщений vk.com для мессенджера Franz предназначен для отправки и получения сообщений социальной сети vk.com с помощью мессенджера Franz. Мессенджер Franz это open source мессенджер, объединяющий в одном клиентском приложении такие мессенджеры и чат-сервисы как WhatsApp, Telegram, Slack, Facebook Messenger, Skype, Discord, WeChat и многие другие. В настоящий момент доступна только десктоп-версия приложения. Мессенджер Franz реализован с помощью фреймворка Electron.

- Вызов и загрузка.
Для использования плагина необходимо скачать и установить мессенджер Franz c оф. сайта  https://meetfranz.com .
Установка dev-версии (версии разработчика) плагина (recipe).
1. Скачать архив с плагином с github.com по ссылке: https://github.com/radioaktive/recipe-vk .
2. Открыть папку recipes на Вашем компьютере, и создать (если не существует) [Franz] в ней папку dev .
    Mac: ~/Library/Application Support/Franz/recipes/dev/
    Windows: C:/Users/ ... %appdata%/Franz/recipes/dev/
    Linux: ~/.config/Franz/recipes/dev
3. Создать в папке dev папку vk и распаковать в нее скачанный архив плагина (файлы icon.svg , index.js, package.json, webview.js, service.css).
4. Перезагрузить мессенджер Franz.
5. На левой панели мессенджера нажать кнопку "+" (Add new service).
6. В появившемся окне в вверху должен появится раздел "Development".
Необходимо нажать на кнопку раздела "Development", далее нажать "vk" (см. рис. 1) и активировать плагин.

![](/add.jpg)



Рисунок 1 - Активация плагина сообщений vk.com.

7. На левой панели мессенджера должна появиться кнопка с логотипом vk.com, ее нужно нажать и авторизоваться в vk.com.
8. В мессенджере отобразиться окно с собщениями vk.com. Если у Вас есть непрочитанные сообщения, счетчик непрочитанных сообщений должен отобразиться в красном кружке  на кнопке с логотипом vk.com на левой панели мессенджера (см. рис. 2).


![](/vkmessages.jpg)

Рисунок 2 - Окно месенджера Franz с сообщениями vk.com.

Список использованных источников
---
1. Олифер В., Олифер Н. Компьютерные сети. Принципы, технологии, протоколы: Учебник для вузов. 5-е изд. — СПб.: Питер, 2016. — 992 с.: ил. — (Серия «Учебник для вузов»). — ISBN 978-5-496-01967-5.
2. Шемсединов Т. Node.js и JavaScript вместо ветхого веба. [Электронный ресурс] — М.: 2016. // Режим доступа - https://habrahabr.ru/post/306584/
3.  ГОСТ 19.401-78 «Единая система программной документации (ЕСПД). Текст программы. Требования к содержанию и оформлению» [Текст] : ГОСТ 19.401–78.- Введ.1980-01-01.
4. Franz Recipe Documentation / Overview [Электронный ресурс] — 2018. // Режим доступа - https://github.com/meetfranz/plugins/blob/master/docs/integration.md



Приложение A
---
Текст программы главного файла плагина index.js на языке JavaScript.
(код код также доступен на github.com по ссылке: https://github.com/radioaktive/recipe-vk/blob/master/index.js )

```
'use strict';

module.exports = Franz => class Vk extends Franz {
  overrideUserAgent() {
    return window.navigator.userAgent.replace(/(Franz|Electron)([^\s]+\s)/g, '');
  }
};
```

Приложение Б
---
Текст программы файла плагина webview.js
 на языке JavaScript.
(код также доступен на github.com по ссылке: https://github.com/radioaktive/recipe-vk/blob/master/webview.js )

```
'use strict';

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

module.exports = Franz => {
  const getMessages = function getMessages() {
    const mailSel = document.querySelector('#l_msg span.inl_bl.left_count');
    let count = parseInt(mailSel.innerHTML, 10);
    Franz.setBadge(count);
  };

  Franz.loop(getMessages);

  // inject franz.css stylesheet
  Franz.injectCSS(_path2.default.join(__dirname, 'service.css'));
};
```

Приложение В
---
Текст программы файла плагина package.json
 в формате json.
(код также доступен на github.com по ссылке: https://github.com/radioaktive/recipe-vk/blob/master/package.json )
```
{
  "id": "vk",
  "name": "Vk",
  "version": "1.0.3",
  "description": "vk.com messenger",
  "main": "index.js",
  "author": "Pasha R <radioaktive@hotmail.ru>, Ilia Z, ",
  "license": "MIT",
  "config": {
    "serviceURL": "https://vk.com/im",
    "hasNotificationSound": true
  }
}
```
Приложение Г
---

Текст программы файла плагина service.css на языке css.
(код также доступен на github.com по ссылке: https://github.com/radioaktive/recipe-vk/blob/master/service.css )

```
#ads_left {
	display: none !important;
}
.ads_ad_box {
	display: none !important;
}
```
